{"remainingRequest":"/Users/apple/Documents/VS Code/wor_on_demand_fonrtend/node_modules/babel-loader/lib/index.js!/Users/apple/Documents/VS Code/wor_on_demand_fonrtend/src/@fake-db/jwt/index.js","dependencies":[{"path":"/Users/apple/Documents/VS Code/wor_on_demand_fonrtend/src/@fake-db/jwt/index.js","mtime":1658909892000},{"path":"/Users/apple/Documents/VS Code/wor_on_demand_fonrtend/node_modules/cache-loader/dist/cjs.js","mtime":1658911406000},{"path":"/Users/apple/Documents/VS Code/wor_on_demand_fonrtend/node_modules/babel-loader/lib/index.js","mtime":1658911406000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiL1VzZXJzL2FwcGxlL0RvY3VtZW50cy9WUyBDb2RlL3dvcl9vbl9kZW1hbmRfZm9ucnRlbmQvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL29iamVjdFNwcmVhZDIiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maW5kLmpzIjsKaW1wb3J0IG1vY2sgZnJvbSAnQC9AZmFrZS1kYi9tb2NrJzsKaW1wb3J0IGp3dCBmcm9tICdqc29ud2VidG9rZW4nOwp2YXIgZGF0YSA9IHsKICB1c2VyczogW3sKICAgIGlkOiAxLAogICAgZnVsbE5hbWU6ICdKb2huIERvZScsCiAgICB1c2VybmFtZTogJ2pvaG5kb2UnLAogICAgcGFzc3dvcmQ6ICdhZG1pbicsCiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZ2xvYmFsLXJlcXVpcmUKICAgIGF2YXRhcjogcmVxdWlyZSgnQC9hc3NldHMvaW1hZ2VzL2F2YXRhcnMvMTMtc21hbGwucG5nJyksCiAgICBlbWFpbDogJ2FkbWluQGRlbW8uY29tJywKICAgIHJvbGU6ICdhZG1pbicsCiAgICBhYmlsaXR5OiBbewogICAgICBhY3Rpb246ICdtYW5hZ2UnLAogICAgICBzdWJqZWN0OiAnYWxsJwogICAgfV0sCiAgICBleHRyYXM6IHsKICAgICAgZUNvbW1lcmNlQ2FydEl0ZW1zQ291bnQ6IDUKICAgIH0KICB9LCB7CiAgICBpZDogMiwKICAgIGZ1bGxOYW1lOiAnSmFuZSBEb2UnLAogICAgdXNlcm5hbWU6ICdqYW5lZG9lJywKICAgIHBhc3N3b3JkOiAnY2xpZW50JywKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBnbG9iYWwtcmVxdWlyZQogICAgYXZhdGFyOiByZXF1aXJlKCdAL2Fzc2V0cy9pbWFnZXMvYXZhdGFycy8xLXNtYWxsLnBuZycpLAogICAgZW1haWw6ICdjbGllbnRAZGVtby5jb20nLAogICAgcm9sZTogJ2NsaWVudCcsCiAgICBhYmlsaXR5OiBbewogICAgICBhY3Rpb246ICdyZWFkJywKICAgICAgc3ViamVjdDogJ0FDTCcKICAgIH0sIHsKICAgICAgYWN0aW9uOiAncmVhZCcsCiAgICAgIHN1YmplY3Q6ICdBdXRoJwogICAgfV0sCiAgICBleHRyYXM6IHsKICAgICAgZUNvbW1lcmNlQ2FydEl0ZW1zQ291bnQ6IDUKICAgIH0KICB9XQp9OyAvLyAhIFRoZXNlIHR3byBzZWNyZXRzIHNoYWxsIGJlIGluIC5lbnYgZmlsZSBhbmQgbm90IGluIGFueSBvdGhlciBmaWxlCgp2YXIgand0Q29uZmlnID0gewogIHNlY3JldDogJ2RkNWYzMDg5LTQwYzMtNDAzZC1hZjE0LWQwYzIyOGIwNWNiNCcsCiAgcmVmcmVzaFRva2VuU2VjcmV0OiAnN2M0YzFjNTAtMzIzMC00NWJmLTllYWUtYzliMmU0MDFjNzY3JywKICBleHBpcmVUaW1lOiAnMTBtJywKICByZWZyZXNoVG9rZW5FeHBpcmVUaW1lOiAnMTBtJwp9Owptb2NrLm9uUG9zdCgnL2p3dC9sb2dpbicpLnJlcGx5KGZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgdmFyIF9KU09OJHBhcnNlID0gSlNPTi5wYXJzZShyZXF1ZXN0LmRhdGEpLAogICAgICBlbWFpbCA9IF9KU09OJHBhcnNlLmVtYWlsLAogICAgICBwYXNzd29yZCA9IF9KU09OJHBhcnNlLnBhc3N3b3JkOwoKICB2YXIgZXJyb3IgPSB7CiAgICBlbWFpbDogWydTb21ldGhpbmcgd2VudCB3cm9uZyddCiAgfTsKICB2YXIgdXNlciA9IGRhdGEudXNlcnMuZmluZChmdW5jdGlvbiAodSkgewogICAgcmV0dXJuIHUuZW1haWwgPT09IGVtYWlsICYmIHUucGFzc3dvcmQgPT09IHBhc3N3b3JkOwogIH0pOwoKICBpZiAodXNlcikgewogICAgdHJ5IHsKICAgICAgdmFyIGFjY2Vzc1Rva2VuID0gand0LnNpZ24oewogICAgICAgIGlkOiB1c2VyLmlkCiAgICAgIH0sIGp3dENvbmZpZy5zZWNyZXQsIHsKICAgICAgICBleHBpcmVzSW46IGp3dENvbmZpZy5leHBpcmVUaW1lCiAgICAgIH0pOwogICAgICB2YXIgcmVmcmVzaFRva2VuID0gand0LnNpZ24oewogICAgICAgIGlkOiB1c2VyLmlkCiAgICAgIH0sIGp3dENvbmZpZy5yZWZyZXNoVG9rZW5TZWNyZXQsIHsKICAgICAgICBleHBpcmVzSW46IGp3dENvbmZpZy5yZWZyZXNoVG9rZW5FeHBpcmVUaW1lCiAgICAgIH0pOwoKICAgICAgdmFyIHVzZXJEYXRhID0gX29iamVjdFNwcmVhZCh7fSwgdXNlcik7CgogICAgICBkZWxldGUgdXNlckRhdGEucGFzc3dvcmQ7CiAgICAgIHZhciByZXNwb25zZSA9IHsKICAgICAgICB1c2VyRGF0YTogdXNlckRhdGEsCiAgICAgICAgYWNjZXNzVG9rZW46IGFjY2Vzc1Rva2VuLAogICAgICAgIHJlZnJlc2hUb2tlbjogcmVmcmVzaFRva2VuCiAgICAgIH07CiAgICAgIHJldHVybiBbMjAwLCByZXNwb25zZV07CiAgICB9IGNhdGNoIChlKSB7CiAgICAgIGVycm9yID0gZTsKICAgIH0KICB9IGVsc2UgewogICAgZXJyb3IgPSB7CiAgICAgIGVtYWlsOiBbJ0VtYWlsIG9yIFBhc3N3b3JkIGlzIEludmEnXQogICAgfTsKICB9CgogIHJldHVybiBbNDAwLCB7CiAgICBlcnJvcjogZXJyb3IKICB9XTsKfSk7Cm1vY2sub25Qb3N0KCcvand0L3JlZ2lzdGVyJykucmVwbHkoZnVuY3Rpb24gKHJlcXVlc3QpIHsKICB2YXIgX0pTT04kcGFyc2UyID0gSlNPTi5wYXJzZShyZXF1ZXN0LmRhdGEpLAogICAgICB1c2VybmFtZSA9IF9KU09OJHBhcnNlMi51c2VybmFtZSwKICAgICAgZW1haWwgPSBfSlNPTiRwYXJzZTIuZW1haWwsCiAgICAgIHBhc3N3b3JkID0gX0pTT04kcGFyc2UyLnBhc3N3b3JkOyAvLyBJZiBub3QgYW55IG9mIGRhdGEgaXMgbWlzc2luZyByZXR1cm4gNDAwCgoKICBpZiAoISh1c2VybmFtZSAmJiBlbWFpbCAmJiBwYXNzd29yZCkpIHJldHVybiBbNDAwXTsKICB2YXIgaXNFbWFpbEFscmVhZHlJblVzZSA9IGRhdGEudXNlcnMuZmluZChmdW5jdGlvbiAodXNlcikgewogICAgcmV0dXJuIHVzZXIuZW1haWwgPT09IGVtYWlsOwogIH0pOwogIHZhciBpc1VzZXJuYW1lQWxyZWFkeUluVXNlID0gZGF0YS51c2Vycy5maW5kKGZ1bmN0aW9uICh1c2VyKSB7CiAgICByZXR1cm4gdXNlci51c2VybmFtZSA9PT0gdXNlcm5hbWU7CiAgfSk7CiAgdmFyIGVycm9yID0gewogICAgcGFzc3dvcmQ6ICFwYXNzd29yZCA/IFsnUGxlYXNlIGVudGVyIHBhc3N3b3JkJ10gOiBudWxsLAogICAgZW1haWw6IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKCFlbWFpbCkgcmV0dXJuIFsnUGxlYXNlIGVudGVyIHlvdXIgZW1haWwuJ107CiAgICAgIGlmIChpc0VtYWlsQWxyZWFkeUluVXNlKSByZXR1cm4gWydUaGlzIGVtYWlsIGlzIGFscmVhZHkgaW4gdXNlLiddOwogICAgICByZXR1cm4gbnVsbDsKICAgIH0oKSwKICAgIHVzZXJuYW1lOiBmdW5jdGlvbiAoKSB7CiAgICAgIGlmICghdXNlcm5hbWUpIHJldHVybiBbJ1BsZWFzZSBlbnRlciB5b3VyIHVzZXJuYW1lLiddOwogICAgICBpZiAoaXNVc2VybmFtZUFscmVhZHlJblVzZSkgcmV0dXJuIFsnVGhpcyB1c2VybmFtZSBpcyBhbHJlYWR5IGluIHVzZS4nXTsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9KCkKICB9OwoKICBpZiAoIWVycm9yLnVzZXJuYW1lICYmICFlcnJvci5lbWFpbCkgewogICAgdmFyIHVzZXJEYXRhID0gewogICAgICBlbWFpbDogZW1haWwsCiAgICAgIHBhc3N3b3JkOiBwYXNzd29yZCwKICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lLAogICAgICBmdWxsTmFtZTogJycsCiAgICAgIGF2YXRhcjogbnVsbCwKICAgICAgcm9sZTogJ2FkbWluJywKICAgICAgYWJpbGl0eTogW3sKICAgICAgICBhY3Rpb246ICdtYW5hZ2UnLAogICAgICAgIHN1YmplY3Q6ICdhbGwnCiAgICAgIH1dCiAgICB9OyAvLyBBZGQgdXNlciBpZAoKICAgIHZhciBsZW5ndGggPSBkYXRhLnVzZXJzLmxlbmd0aDsKICAgIHZhciBsYXN0SW5kZXggPSAwOwoKICAgIGlmIChsZW5ndGgpIHsKICAgICAgbGFzdEluZGV4ID0gZGF0YS51c2Vyc1tsZW5ndGggLSAxXS5pZDsKICAgIH0KCiAgICB1c2VyRGF0YS5pZCA9IGxhc3RJbmRleCArIDE7CiAgICBkYXRhLnVzZXJzLnB1c2godXNlckRhdGEpOwogICAgdmFyIGFjY2Vzc1Rva2VuID0gand0LnNpZ24oewogICAgICBpZDogdXNlckRhdGEuaWQKICAgIH0sIGp3dENvbmZpZy5zZWNyZXQsIHsKICAgICAgZXhwaXJlc0luOiBqd3RDb25maWcuZXhwaXJlVGltZQogICAgfSk7CgogICAgdmFyIHVzZXIgPSBfb2JqZWN0U3ByZWFkKHt9LCB1c2VyRGF0YSk7CgogICAgZGVsZXRlIHVzZXIucGFzc3dvcmQ7CiAgICB2YXIgcmVzcG9uc2UgPSB7CiAgICAgIHVzZXJEYXRhOiB1c2VyLAogICAgICBhY2Nlc3NUb2tlbjogYWNjZXNzVG9rZW4KICAgIH07CiAgICByZXR1cm4gWzIwMCwgcmVzcG9uc2VdOwogIH0KCiAgcmV0dXJuIFs0MDAsIHsKICAgIGVycm9yOiBlcnJvcgogIH1dOwp9KTsKbW9jay5vblBvc3QoJy9qd3QvcmVmcmVzaC10b2tlbicpLnJlcGx5KGZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgdmFyIF9KU09OJHBhcnNlMyA9IEpTT04ucGFyc2UocmVxdWVzdC5kYXRhKSwKICAgICAgcmVmcmVzaFRva2VuID0gX0pTT04kcGFyc2UzLnJlZnJlc2hUb2tlbjsKCiAgdHJ5IHsKICAgIHZhciBfand0JHZlcmlmeSA9IGp3dC52ZXJpZnkocmVmcmVzaFRva2VuLCBqd3RDb25maWcucmVmcmVzaFRva2VuU2VjcmV0KSwKICAgICAgICBpZCA9IF9qd3QkdmVyaWZ5LmlkOwoKICAgIHZhciB1c2VyRGF0YSA9IF9vYmplY3RTcHJlYWQoe30sIGRhdGEudXNlcnMuZmluZChmdW5jdGlvbiAodXNlcikgewogICAgICByZXR1cm4gdXNlci5pZCA9PT0gaWQ7CiAgICB9KSk7CgogICAgdmFyIG5ld0FjY2Vzc1Rva2VuID0gand0LnNpZ24oewogICAgICBpZDogdXNlckRhdGEuaWQKICAgIH0sIGp3dENvbmZpZy5zZWNyZXQsIHsKICAgICAgZXhwaXJlc0luOiBqd3RDb25maWcuZXhwaXJlc0luCiAgICB9KTsKICAgIHZhciBuZXdSZWZyZXNoVG9rZW4gPSBqd3Quc2lnbih7CiAgICAgIGlkOiB1c2VyRGF0YS5pZAogICAgfSwgand0Q29uZmlnLnJlZnJlc2hUb2tlblNlY3JldCwgewogICAgICBleHBpcmVzSW46IGp3dENvbmZpZy5yZWZyZXNoVG9rZW5FeHBpcmVUaW1lCiAgICB9KTsKICAgIGRlbGV0ZSB1c2VyRGF0YS5wYXNzd29yZDsKICAgIHZhciByZXNwb25zZSA9IHsKICAgICAgdXNlckRhdGE6IHVzZXJEYXRhLAogICAgICBhY2Nlc3NUb2tlbjogbmV3QWNjZXNzVG9rZW4sCiAgICAgIHJlZnJlc2hUb2tlbjogbmV3UmVmcmVzaFRva2VuCiAgICB9OwogICAgcmV0dXJuIFsyMDAsIHJlc3BvbnNlXTsKICB9IGNhdGNoIChlKSB7CiAgICB2YXIgZXJyb3IgPSAnSW52YWxpZCByZWZyZXNoIHRva2VuJzsKICAgIHJldHVybiBbNDAxLCB7CiAgICAgIGVycm9yOiBlcnJvcgogICAgfV07CiAgfQp9KTs="},{"version":3,"sources":["/Users/apple/Documents/VS Code/wor_on_demand_fonrtend/src/@fake-db/jwt/index.js"],"names":["mock","jwt","data","users","id","fullName","username","password","avatar","require","email","role","ability","action","subject","extras","eCommerceCartItemsCount","jwtConfig","secret","refreshTokenSecret","expireTime","refreshTokenExpireTime","onPost","reply","request","JSON","parse","error","user","find","u","accessToken","sign","expiresIn","refreshToken","userData","response","e","isEmailAlreadyInUse","isUsernameAlreadyInUse","length","lastIndex","push","verify","newAccessToken","newRefreshToken"],"mappings":"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","sourcesContent":["import mock from '@/@fake-db/mock'\nimport jwt from 'jsonwebtoken'\n\nconst data = {\n  users: [\n    {\n      id: 1,\n      fullName: 'John Doe',\n      username: 'johndoe',\n      password: 'admin',\n      // eslint-disable-next-line global-require\n      avatar: require('@/assets/images/avatars/13-small.png'),\n      email: 'admin@demo.com',\n      role: 'admin',\n      ability: [\n        {\n          action: 'manage',\n          subject: 'all',\n        },\n      ],\n      extras: {\n        eCommerceCartItemsCount: 5,\n      },\n    },\n    {\n      id: 2,\n      fullName: 'Jane Doe',\n      username: 'janedoe',\n      password: 'client',\n      // eslint-disable-next-line global-require\n      avatar: require('@/assets/images/avatars/1-small.png'),\n      email: 'client@demo.com',\n      role: 'client',\n      ability: [\n        {\n          action: 'read',\n          subject: 'ACL',\n        },\n        {\n          action: 'read',\n          subject: 'Auth',\n        },\n      ],\n      extras: {\n        eCommerceCartItemsCount: 5,\n      },\n    },\n  ],\n}\n\n// ! These two secrets shall be in .env file and not in any other file\nconst jwtConfig = {\n  secret: 'dd5f3089-40c3-403d-af14-d0c228b05cb4',\n  refreshTokenSecret: '7c4c1c50-3230-45bf-9eae-c9b2e401c767',\n  expireTime: '10m',\n  refreshTokenExpireTime: '10m',\n}\n\nmock.onPost('/jwt/login').reply(request => {\n  const { email, password } = JSON.parse(request.data)\n\n  let error = {\n    email: ['Something went wrong'],\n  }\n\n  const user = data.users.find(u => u.email === email && u.password === password)\n\n  if (user) {\n    try {\n      const accessToken = jwt.sign({ id: user.id }, jwtConfig.secret, { expiresIn: jwtConfig.expireTime })\n      const refreshToken = jwt.sign({ id: user.id }, jwtConfig.refreshTokenSecret, {\n        expiresIn: jwtConfig.refreshTokenExpireTime,\n      })\n\n      const userData = { ...user }\n\n      delete userData.password\n\n      const response = {\n        userData,\n        accessToken,\n        refreshToken,\n      }\n\n      return [200, response]\n    } catch (e) {\n      error = e\n    }\n  } else {\n    error = {\n      email: ['Email or Password is Inva'],\n    }\n  }\n\n  return [400, { error }]\n})\n\nmock.onPost('/jwt/register').reply(request => {\n  const { username, email, password } = JSON.parse(request.data)\n\n  // If not any of data is missing return 400\n  if (!(username && email && password)) return [400]\n\n  const isEmailAlreadyInUse = data.users.find(user => user.email === email)\n  const isUsernameAlreadyInUse = data.users.find(user => user.username === username)\n\n  const error = {\n    password: !password ? ['Please enter password'] : null,\n    email: (() => {\n      if (!email) return ['Please enter your email.']\n      if (isEmailAlreadyInUse) return ['This email is already in use.']\n      return null\n    })(),\n    username: (() => {\n      if (!username) return ['Please enter your username.']\n      if (isUsernameAlreadyInUse) return ['This username is already in use.']\n      return null\n    })(),\n  }\n\n  if (!error.username && !error.email) {\n    const userData = {\n      email,\n      password,\n      username,\n      fullName: '',\n      avatar: null,\n      role: 'admin',\n      ability: [\n        {\n          action: 'manage',\n          subject: 'all',\n        },\n      ],\n    }\n\n    // Add user id\n    const { length } = data.users\n    let lastIndex = 0\n    if (length) {\n      lastIndex = data.users[length - 1].id\n    }\n    userData.id = lastIndex + 1\n\n    data.users.push(userData)\n\n    const accessToken = jwt.sign({ id: userData.id }, jwtConfig.secret, { expiresIn: jwtConfig.expireTime })\n\n    const user = { ...userData }\n    delete user.password\n    const response = {\n      userData: user,\n      accessToken,\n    }\n\n    return [200, response]\n  }\n  return [400, { error }]\n})\n\nmock.onPost('/jwt/refresh-token').reply(request => {\n  const { refreshToken } = JSON.parse(request.data)\n\n  try {\n    const { id } = jwt.verify(refreshToken, jwtConfig.refreshTokenSecret)\n\n    const userData = { ...data.users.find(user => user.id === id) }\n\n    const newAccessToken = jwt.sign({ id: userData.id }, jwtConfig.secret, { expiresIn: jwtConfig.expiresIn })\n    const newRefreshToken = jwt.sign({ id: userData.id }, jwtConfig.refreshTokenSecret, {\n      expiresIn: jwtConfig.refreshTokenExpireTime,\n    })\n\n    delete userData.password\n    const response = {\n      userData,\n      accessToken: newAccessToken,\n      refreshToken: newRefreshToken,\n    }\n\n    return [200, response]\n  } catch (e) {\n    const error = 'Invalid refresh token'\n    return [401, { error }]\n  }\n})\n"]}]}